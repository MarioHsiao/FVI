Imports Bio

Namespace Szunyi
    Namespace Protein

        Public Class Instability
            Public Property DIWV As New Dictionary(Of String, Double)
            Public Sub New()
                DIWV.Add("AA", 1)
                DIWV.Add("AC", 44.94)
                DIWV.Add("AD", -7.49)
                DIWV.Add("AE", 1)
                DIWV.Add("AF", 1)
                DIWV.Add("AG", 1)
                DIWV.Add("AH", -7.49)
                DIWV.Add("AI", 1)
                DIWV.Add("AK", 1)
                DIWV.Add("AL", 1)
                DIWV.Add("AM", 1)
                DIWV.Add("AN", 1)
                DIWV.Add("AP", 20.26)
                DIWV.Add("AQ", 1)
                DIWV.Add("AR", 1)
                DIWV.Add("AS", 1)
                DIWV.Add("AT", 1)
                DIWV.Add("AV", 1)
                DIWV.Add("AW", 1)
                DIWV.Add("AY", 1)
                DIWV.Add("CA", 1)
                DIWV.Add("CC", 1)
                DIWV.Add("CD", 20.26)
                DIWV.Add("CE", 1)
                DIWV.Add("CF", 1)
                DIWV.Add("CG", 1)
                DIWV.Add("CH", 33.6)
                DIWV.Add("CI", 1)
                DIWV.Add("CK", 1)
                DIWV.Add("CL", 20.26)
                DIWV.Add("CM", 33.6)
                DIWV.Add("CN", 1)
                DIWV.Add("CP", 20.26)
                DIWV.Add("CQ", -6.54)
                DIWV.Add("CR", 1)
                DIWV.Add("CT", 33.6)
                DIWV.Add("CV", -6.54)
                DIWV.Add("CW", 24.68)
                DIWV.Add("CY", 1)
                DIWV.Add("CS", 1)
                DIWV.Add("DA", 1)
                DIWV.Add("DC", 1)
                DIWV.Add("DD", 1)
                DIWV.Add("DE", 1)
                DIWV.Add("DF", -6.54)
                DIWV.Add("DG", 1)
                DIWV.Add("DH", 1)
                DIWV.Add("DI", 1)
                DIWV.Add("DK", -7.49)
                DIWV.Add("DL", 1)
                DIWV.Add("DM", 1)
                DIWV.Add("DN", 1)
                DIWV.Add("DP", 1)
                DIWV.Add("DQ", 1)
                DIWV.Add("DR", -6.54)
                DIWV.Add("DS", 20.26)
                DIWV.Add("DT", -14.03)
                DIWV.Add("DV", 1)
                DIWV.Add("DW", 1)
                DIWV.Add("DY", 1)
                DIWV.Add("EA", 1)
                DIWV.Add("EC", 44.94)
                DIWV.Add("ED", 20.26)
                DIWV.Add("EE", 33.6)
                DIWV.Add("EF", 1)
                DIWV.Add("EG", 1)
                DIWV.Add("EH", -6.54)
                DIWV.Add("EI", 20.26)
                DIWV.Add("EK", 1)
                DIWV.Add("EL", 1)
                DIWV.Add("EM", 1)
                DIWV.Add("EN", 1)
                DIWV.Add("EP", 20.26)
                DIWV.Add("EQ", 20.26)
                DIWV.Add("ER", 1)
                DIWV.Add("ES", 20.26)
                DIWV.Add("ET", 1)
                DIWV.Add("EV", 1)
                DIWV.Add("EW", -14.03)
                DIWV.Add("EY", 1)
                DIWV.Add("FA", 1)
                DIWV.Add("FC", 1)
                DIWV.Add("FD", 13.34)
                DIWV.Add("FE", 1)
                DIWV.Add("FF", 1)
                DIWV.Add("FG", 1)
                DIWV.Add("FH", 1)
                DIWV.Add("FI", 1)
                DIWV.Add("FK", -14.03)
                DIWV.Add("FL", 1)
                DIWV.Add("FM", 1)
                DIWV.Add("FN", 1)
                DIWV.Add("FP", 20.26)
                DIWV.Add("FQ", 1)
                DIWV.Add("FR", 1)
                DIWV.Add("FS", 1)
                DIWV.Add("FT", 1)
                DIWV.Add("FV", 1)
                DIWV.Add("FW", 1)
                DIWV.Add("FY", 33.6)
                DIWV.Add("GA", -7.49)
                DIWV.Add("GC", 1)
                DIWV.Add("GD", 1)
                DIWV.Add("GE", -6.54)
                DIWV.Add("GF", 1)
                DIWV.Add("GG", 13.34)
                DIWV.Add("GH", 1)
                DIWV.Add("GI", -7.49)
                DIWV.Add("GK", -7.49)
                DIWV.Add("GL", 1)
                DIWV.Add("GM", 1)
                DIWV.Add("GN", -7.49)
                DIWV.Add("GP", 1)
                DIWV.Add("GQ", 1)
                DIWV.Add("GR", 1)
                DIWV.Add("GS", 1)
                DIWV.Add("GT", -7.49)
                DIWV.Add("GV", 1)
                DIWV.Add("GW", 13.34)
                DIWV.Add("GY", -7.49)
                DIWV.Add("HA", 1)
                DIWV.Add("HC", 1)
                DIWV.Add("HD", 1)
                DIWV.Add("HE", 1)
                DIWV.Add("HF", -9.37)
                DIWV.Add("HG", -9.37)
                DIWV.Add("HH", 1)
                DIWV.Add("HI", 44.94)
                DIWV.Add("HK", 24.68)
                DIWV.Add("HL", 1)
                DIWV.Add("HM", 1)
                DIWV.Add("HN", 24.68)
                DIWV.Add("HP", -1.88)
                DIWV.Add("HQ", 1)
                DIWV.Add("HR", 1)
                DIWV.Add("HS", 1)
                DIWV.Add("HT", -6.54)
                DIWV.Add("HV", 1)
                DIWV.Add("HW", -1.88)
                DIWV.Add("HY", 44.94)
                DIWV.Add("IA", 1)
                DIWV.Add("IC", 1)
                DIWV.Add("ID", 1)
                DIWV.Add("IE", 44.94)
                DIWV.Add("IF", 1)
                DIWV.Add("IG", 1)
                DIWV.Add("IH", 13.34)
                DIWV.Add("II", 1)
                DIWV.Add("IK", -7.49)
                DIWV.Add("IL", 20.26)
                DIWV.Add("IM", 1)
                DIWV.Add("IN", 1)
                DIWV.Add("IP", -1.88)
                DIWV.Add("IQ", 1)
                DIWV.Add("IR", 1)
                DIWV.Add("IS", 1)
                DIWV.Add("IT", 1)
                DIWV.Add("IV", -7.49)
                DIWV.Add("IW", 1)
                DIWV.Add("IY", 1)
                DIWV.Add("KA", 1)
                DIWV.Add("KC", 1)
                DIWV.Add("KD", 1)
                DIWV.Add("KE", 1)
                DIWV.Add("KF", 1)
                DIWV.Add("KG", -7.49)
                DIWV.Add("KH", 1)
                DIWV.Add("KI", -7.49)
                DIWV.Add("KK", 1)
                DIWV.Add("KL", -7.49)
                DIWV.Add("KM", 33.6)
                DIWV.Add("KN", 1)
                DIWV.Add("KP", -6.54)
                DIWV.Add("KQ", 24.68)
                DIWV.Add("KR", 33.6)
                DIWV.Add("KS", 1)
                DIWV.Add("KT", 1)
                DIWV.Add("KV", -7.49)
                DIWV.Add("KW", 1)
                DIWV.Add("KY", 1)
                DIWV.Add("LA", 1)
                DIWV.Add("LC", 1)
                DIWV.Add("LD", 1)
                DIWV.Add("LE", 1)
                DIWV.Add("LF", 1)
                DIWV.Add("LG", 1)
                DIWV.Add("LH", 1)
                DIWV.Add("LI", 1)
                DIWV.Add("LK", -7.49)
                DIWV.Add("LL", 1)
                DIWV.Add("LM", 1)
                DIWV.Add("LN", 1)
                DIWV.Add("LP", 20.26)
                DIWV.Add("LQ", 33.6)
                DIWV.Add("LR", 20.26)
                DIWV.Add("LS", 1)
                DIWV.Add("LT", 1)
                DIWV.Add("LV", 1)
                DIWV.Add("LW", 24.68)
                DIWV.Add("LY", 1)
                DIWV.Add("MA", 13.34)
                DIWV.Add("MC", 1)
                DIWV.Add("MD", 1)
                DIWV.Add("ME", 1)
                DIWV.Add("MF", 1)
                DIWV.Add("MG", 1)
                DIWV.Add("MH", 58.28)
                DIWV.Add("MI", 1)
                DIWV.Add("MK", 1)
                DIWV.Add("ML", 1)
                DIWV.Add("MM", -1.88)
                DIWV.Add("MN", 1)
                DIWV.Add("MP", 44.94)
                DIWV.Add("MQ", -6.54)
                DIWV.Add("MR", -6.54)
                DIWV.Add("MS", 44.94)
                DIWV.Add("MT", -1.88)
                DIWV.Add("MV", 1)
                DIWV.Add("MW", 1)
                DIWV.Add("MY", 24.68)
                DIWV.Add("NC", -1.88)
                DIWV.Add("ND", 1)
                DIWV.Add("NE", 1)
                DIWV.Add("NF", -14.03)
                DIWV.Add("NG", -14.03)
                DIWV.Add("NH", 1)
                DIWV.Add("NI", 44.94)
                DIWV.Add("NK", 24.68)
                DIWV.Add("NL", 1)
                DIWV.Add("NM", 1)
                DIWV.Add("NN", 1)
                DIWV.Add("NP", -1.88)
                DIWV.Add("NQ", -6.54)
                DIWV.Add("NR", 1)
                DIWV.Add("NS", 1)
                DIWV.Add("NT", -7.49)
                DIWV.Add("NV", 1)
                DIWV.Add("NW", -9.37)
                DIWV.Add("NY", 1)
                DIWV.Add("PA", 20.26)
                DIWV.Add("PC", -6.54)
                DIWV.Add("PD", -6.54)
                DIWV.Add("PE", 18.38)
                DIWV.Add("PF", 20.26)
                DIWV.Add("PG", 1)
                DIWV.Add("PH", 1)
                DIWV.Add("PI", 1)
                DIWV.Add("PK", 1)
                DIWV.Add("PL", 1)
                DIWV.Add("PM", -6.54)
                DIWV.Add("PN", 1)
                DIWV.Add("PP", 20.26)
                DIWV.Add("PQ", 20.26)
                DIWV.Add("PR", -6.54)
                DIWV.Add("PS", 20.26)
                DIWV.Add("PT", 1)
                DIWV.Add("PV", 20.26)
                DIWV.Add("PW", -1.88)
                DIWV.Add("PY", 1)
                DIWV.Add("QA", 1)
                DIWV.Add("QC", -6.54)
                DIWV.Add("QD", 20.26)
                DIWV.Add("QE", 20.26)
                DIWV.Add("QF", -6.54)
                DIWV.Add("QG", 1)
                DIWV.Add("QH", 1)
                DIWV.Add("QI", 1)
                DIWV.Add("QK", 1)
                DIWV.Add("QL", 1)
                DIWV.Add("QM", 1)
                DIWV.Add("QN", 1)
                DIWV.Add("QP", 20.26)
                DIWV.Add("QQ", 20.26)
                DIWV.Add("QR", 1)
                DIWV.Add("QS", 44.94)
                DIWV.Add("QT", 1)
                DIWV.Add("QV", -6.54)
                DIWV.Add("QW", 1)
                DIWV.Add("QY", -6.54)
                DIWV.Add("RA", 1)
                DIWV.Add("RC", 1)
                DIWV.Add("RD", 1)
                DIWV.Add("RE", 1)
                DIWV.Add("RF", 1)
                DIWV.Add("RG", -7.49)
                DIWV.Add("RH", 20.26)
                DIWV.Add("RI", 1)
                DIWV.Add("RK", 1)
                DIWV.Add("RL", 1)
                DIWV.Add("RM", 1)
                DIWV.Add("RN", 13.34)
                DIWV.Add("RP", 20.26)
                DIWV.Add("RQ", 20.26)
                DIWV.Add("RR", 58.28)
                DIWV.Add("RS", 44.94)
                DIWV.Add("RT", 1)
                DIWV.Add("RV", 1)
                DIWV.Add("RW", 58.28)
                DIWV.Add("RY", -6.54)
                DIWV.Add("SA", 1)
                DIWV.Add("SC", 33.6)
                DIWV.Add("SD", 1)
                DIWV.Add("SE", 20.26)
                DIWV.Add("SF", 1)
                DIWV.Add("SG", 1)
                DIWV.Add("SH", 1)
                DIWV.Add("SI", 1)
                DIWV.Add("SK", 1)
                DIWV.Add("SL", 1)
                DIWV.Add("SM", 1)
                DIWV.Add("SN", 1)
                DIWV.Add("SP", 44.94)
                DIWV.Add("SQ", 20.26)
                DIWV.Add("SR", 20.26)
                DIWV.Add("SS", 20.26)
                DIWV.Add("ST", 1)
                DIWV.Add("SV", 1)
                DIWV.Add("SW", 1)
                DIWV.Add("SY", 1)
                DIWV.Add("TA", 1)
                DIWV.Add("TC", 1)
                DIWV.Add("TD", 1)
                DIWV.Add("TE", 20.26)
                DIWV.Add("TF", 13.34)
                DIWV.Add("TG", -7.49)
                DIWV.Add("TH", 1)
                DIWV.Add("TI", 1)
                DIWV.Add("TK", 1)
                DIWV.Add("TL", 1)
                DIWV.Add("TM", 1)
                DIWV.Add("TN", -14.03)
                DIWV.Add("TP", 1)
                DIWV.Add("TQ", -6.54)
                DIWV.Add("TR", 1)
                DIWV.Add("TS", 1)
                DIWV.Add("TT", 1)
                DIWV.Add("TV", 1)
                DIWV.Add("TW", -14.03)
                DIWV.Add("TY", 1)
                DIWV.Add("VA", 1)
                DIWV.Add("VC", 1)
                DIWV.Add("VD", -14.03)
                DIWV.Add("VE", 1)
                DIWV.Add("VF", 1)
                DIWV.Add("VG", -7.49)
                DIWV.Add("VH", 1)
                DIWV.Add("VI", 1)
                DIWV.Add("VK", -1.88)
                DIWV.Add("VL", 1)
                DIWV.Add("VM", 1)
                DIWV.Add("VN", 1)
                DIWV.Add("VP", 20.26)
                DIWV.Add("VQ", 1)
                DIWV.Add("VR", 1)
                DIWV.Add("VS", 1)
                DIWV.Add("VT", -7.49)
                DIWV.Add("VV", 1)
                DIWV.Add("VW", 1)
                DIWV.Add("VY", -6.54)
                DIWV.Add("WA", -14.03)
                DIWV.Add("WC", 1)
                DIWV.Add("WD", 1)
                DIWV.Add("WE", 1)
                DIWV.Add("WF", 1)
                DIWV.Add("WG", -9.37)
                DIWV.Add("WH", 24.68)
                DIWV.Add("WI", 1)
                DIWV.Add("WK", 1)
                DIWV.Add("WL", 13.34)
                DIWV.Add("WM", 24.68)
                DIWV.Add("WN", 13.34)
                DIWV.Add("WP", 1)
                DIWV.Add("WQ", 1)
                DIWV.Add("WR", 1)
                DIWV.Add("WS", 1)
                DIWV.Add("WT", -14.03)
                DIWV.Add("WV", -7.49)
                DIWV.Add("WW", 1)
                DIWV.Add("WY", 1)
                DIWV.Add("YA", 24.68)
                DIWV.Add("YC", 1)
                DIWV.Add("YD", 24.68)
                DIWV.Add("YE", -6.54)
                DIWV.Add("YF", 1)
                DIWV.Add("YG", -7.49)
                DIWV.Add("YH", 13.34)
                DIWV.Add("YI", 1)
                DIWV.Add("YK", 1)
                DIWV.Add("YL", 1)
                DIWV.Add("YM", 44.94)
                DIWV.Add("YN", 1)
                DIWV.Add("YP", 13.34)
                DIWV.Add("YQ", 1)
                DIWV.Add("YR", -15.91)
                DIWV.Add("YS", 1)
                DIWV.Add("YT", -7.49)
                DIWV.Add("YV", 1)
                DIWV.Add("YW", -9.37)
                DIWV.Add("YY", 13.34)
            End Sub
            Public Function Get_Instability_Indexes(Seqs As List(Of Bio.ISequence)) As List(Of Double)
                Dim Res As New List(Of Double)
                For Each Seq In Seqs
                    Res.Add(Get_Instability_Index(Seq))
                Next
                Return Res
            End Function

            Private Function Get_Instability_Index(seq As Bio.ISequence) As Double
                Dim s = Szunyi.Sequences.SequenceManipulation.SeqsToString.GetSeqAsString(seq)
                Dim res As Double = 0
                For i1 = 0 To seq.Count - 2
                    Dim DiPeptide = s.Substring(i1, 2)
                    If DIWV.ContainsKey(DiPeptide) Then
                        res += DIWV(DiPeptide)
                    Else
                        Dim alf As Int16 = 65
                    End If
                Next
                Dim x As Double = (10 / Szunyi.Sequences.SequenceManipulation.Counts.Get_Sequence_Length_Wo_Ter_And_Gap_Symbols(seq)) * res
                Return x
            End Function
        End Class
    End Namespace
End Namespace

